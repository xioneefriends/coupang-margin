<script>
    function calculateMargin() {
        // 입력값 받기
        const salePrice = parseFloat(document.getElementById('salePrice').value);
        const chinaCost = parseFloat(document.getElementById('chinaCost').value);

        // 유효성 검사
        if (isNaN(salePrice) || isNaN(chinaCost) || salePrice <= 0 || chinaCost <= 0) {
            document.getElementById('result').innerHTML = "모든 값을 올바르게 입력해주세요!";
            return;
        }

        // 고정값 설정 (그로스수수료)
        const grossFee = 2500;

        // 수입원가 계산 (중국 원가 * 300)
        const importCost = chinaCost * 300;

        // 판매 수수료 계산 (판매가 * 12%)
        const saleFee = salePrice * 0.12;

        // 부가세 계산 (판매가 / 11 - 수입원가 / 11)
        const vat = (salePrice / 11) - (importCost / 11);

        // 순수익 계산 (판매가 - 수입원가 - 판매수수료 - 그로스수수료 - 부가세)
        const netProfit = salePrice - importCost - saleFee - grossFee - vat;

        // 마진율 계산 (순수익 / 판매가)
        const marginRate = (netProfit / salePrice) * 100;

        // 엔드로아스 계산 (판매가 / 순수익) -> 퍼센트로 표시
        const endros = (salePrice / netProfit) * 100;

        // 출력 항목에 결과 표시 (소수점 이하 제거 및 천 단위 구분 기호 추가)
        document.getElementById('importCost').textContent = Math.floor(importCost).toLocaleString() + ' 원';
        document.getElementById('vat').textContent = Math.floor(vat).toLocaleString() + ' 원';
        document.getElementById('saleFee').textContent = Math.floor(saleFee).toLocaleString() + ' 원';
        document.getElementById('grossFee').textContent = grossFee.toLocaleString() + ' 원';
        document.getElementById('netProfit').textContent = Math.floor(netProfit).toLocaleString() + ' 원';
        document.getElementById('marginRate').textContent = marginRate.toFixed(2) + '%';
        document.getElementById('endros').textContent = endros.toFixed(2) + '%';

        // 결과 창에 순수익과 마진율 표시
        document.getElementById('result').innerHTML = 
            `순수익: ${Math.floor(netProfit).toLocaleString()} 원<br>마진율: ${marginRate.toFixed(2)}%`;
    }

    // 현재 날짜와 시간 표시 (연/월/일/시/분/초)
    function displayDateTime() {
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, '0'); // 월 2자리로 표시
        const day = now.getDate().toString().padStart(2, '0'); // 일 2자리로 표시
        const hours = now.getHours().toString().padStart(2, '0'); // 시간 2자리로 표시
        const minutes = now.getMinutes().toString().padStart(2, '0'); // 분 2자리로 표시
        const seconds = now.getSeconds().toString().padStart(2, '0'); // 초 2자리로 표시

        const dateTimeString = `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;
        document.getElementById('dateTime').textContent = dateTimeString;
    }

    // 페이지 로드 시 날짜 표시 함수 실행
    window.onload = function() {
        displayDateTime();
        setInterval(displayDateTime, 1000); // 1초마다 시간 갱신
    }
</script>
